  0%|                                                                                         | 0/500 [00:00<?, ?it/s]2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_23
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_easy_9
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_medium_18
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_25
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_easy_9
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_medium_18
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_23
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_25
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_easy_9
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_medium_18
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_23
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_25
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_easy_9
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_medium_18
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_25
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_easy_9
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_medium_18
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_23
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_25
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_easy_9
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_23
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_25
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_easy_9
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_23
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_25
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_medium_18
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_23
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_25
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_medium_18
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_hard_23
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_easy_9
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Starting rollout for task: minesweeper_medium_18
2025-08-27 00:33:07 - verifiers.envs.HUDGym - INFO - Initializing MCP client with config: {'minesweeper': {'command': 'docker', 'args': ['run', '--rm', '-i', 'minesweeper:dev']}}
Traceback (most recent call last):
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/verifiers/trainers/grpo_trainer.py", line 691, in _inner_training_loop
    return super()._inner_training_loop(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/transformers/trainer.py", line 2582, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/transformers/trainer.py", line 3790, in training_step
    inputs = self._prepare_inputs(inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/verifiers/trainers/grpo_trainer.py", line 1042, in _prepare_inputs
    batch_result = self.async_generator.get_batch(batch_id_to_retrieve)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/verifiers/trainers/async_batch_generator.py", line 166, in get_batch
    result = self.result_queue.get(timeout=0.1)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/queue.py", line 180, in get
    self.not_empty.wait(remaining)
  File "/home/ubuntu/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/threading.py", line 359, in wait
    gotit = waiter.acquire(True, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/minesweeper/train_minesweeper.py", line 68, in <module>
    main()
  File "/home/ubuntu/minesweeper/train_minesweeper.py", line 61, in main
    trainer.train()
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/transformers/trainer.py", line 2238, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/verifiers/trainers/grpo_trainer.py", line 699, in _inner_training_loop
    self.async_generator.stop()
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/verifiers/trainers/async_batch_generator.py", line 114, in stop
    self.worker_thread.join(timeout=10.0)
  File "/home/ubuntu/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/threading.py", line 1153, in join
    self._wait_for_tstate_lock(timeout=max(timeout, 0))
  File "/home/ubuntu/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/threading.py", line 1169, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Exception ignored in atexit callback: <bound method TracerProvider.shutdown of <opentelemetry.sdk.trace.TracerProvider object at 0x7f37c2acc5f0>>
Traceback (most recent call last):
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1281, in shutdown
    self._active_span_processor.shutdown()
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 180, in shutdown
    sp.shutdown()
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/export/__init__.py", line 196, in shutdown
    return self._batch_processor.shutdown()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/opentelemetry/sdk/_shared_internal/__init__.py", line 194, in shutdown
    self._worker_thread.join(timeout_millis / 1000)
  File "/home/ubuntu/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/threading.py", line 1153, in join
    self._wait_for_tstate_lock(timeout=max(timeout, 0))
  File "/home/ubuntu/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/threading.py", line 1169, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt:
Exception ignored in atexit callback: <function _start_and_connect_service.<locals>.teardown_atexit at 0x7f37c28d5f80>
Traceback (most recent call last):
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/wandb/sdk/lib/service/service_connection.py", line 54, in teardown_atexit
    conn.teardown(hooks.exit_code)
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/wandb/sdk/lib/service/service_connection.py", line 182, in teardown
    self._router.join()
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/wandb/sdk/interface/router.py", line 75, in join
    self._thread.join()
  File "/home/ubuntu/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/threading.py", line 1149, in join
    self._wait_for_tstate_lock()
  File "/home/ubuntu/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/threading.py", line 1169, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt:
Exception ignored in atexit callback: <function shutdown_compile_workers at 0x7f3640bee2a0>
Traceback (most recent call last):
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/torch/_inductor/async_compile.py", line 113, in shutdown_compile_workers
    pool.shutdown()
  File "/home/ubuntu/minesweeper/.venv/lib/python3.12/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 239, in shutdown
    self.process.wait(300)
  File "/home/ubuntu/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/subprocess.py", line 1277, in wait
    self._wait(timeout=sigint_timeout)
  File "/home/ubuntu/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/subprocess.py", line 2047, in _wait
    time.sleep(delay)
KeyboardInterrupt:
